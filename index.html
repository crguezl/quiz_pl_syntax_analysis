<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>REPASO. 2ª PARTE. <br />
ANÁLISIS SINTÁCTICO</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
    <!-- -->
    <style type="text/css" media="all">
      div.quiz, p.comment, div.explanation {display:inline;}
      strong.correct {color:#14B63F;}
      strong.incorrect {color:rgb(255,0,0);}
      strong.mark {color:rgb(255,128,0);}
      input.correct {color:#14B63F; font-weight: bold;}
      input.incorrect {color:rgb(255,0,0); font-weight: bold;}
      div.custom-header {background-color:#7a3b7a; color:#FFFFFF; font-weight: bold;}
      body {padding-top: 20px; padding-bottom: 20px; margin-bottom: 20px;}
      html {position: relative; min-height: 100%;}
      .navbar {margin-bottom: 20px;}
      .btn-footer {text-align: center;}
      #footer {
        position: absolute;
        bottom: 0;
        height: 30px;
        width: inherit;
      }
      div.container {background-color:#EAEAEA;}
      div.explanation {font-style: italic;}
      .nav>li>a.links {
        display: inline; 
        padding: 0; 
        color: #FFFFFF;
      }
      .nav>li>a.links:hover {color: #FFCCFF;}
      /* Inputs size */
      input.size-3 { width: 3em; }

input.size-4 { width: 4em; }

input.size-5 { width: 5em; }

input.size-6 { width: 6em; }

input.size-7 { width: 7em; }

input.size-8 { width: 8em; }

input.size-9 { width: 9em; }

input.size-10 { width: 10em; }

input.size-11 { width: 11em; }

input.size-12 { width: 12em; }

input.size-13 { width: 13em; }

input.size-14 { width: 14em; }

input.size-15 { width: 15em; }

    </style>
    <!-- Any CSS included by the user -->
    
    <!-- Mathjax -->
    
        <script type=text/javascript src=http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML></script>
        <script type=text/javascript>
          MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
        </script>
      
    <!--         -->
  </head>
  <body>
    <div class="container">
      
        <div class="navbar navbar-default custom-header">
          <div class="navbar-header">
            <h3>REPASO. 2ª PARTE. <br />
ANÁLISIS SINTÁCTICO</h3>
          </div>
          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://tinyurl.com/pl1314" class="links">Procesadores de Lenguajes</a></li><br/>
              <li><a href="http://crguezl.github.io/pl-html" class="links">Apuntes</a></li><br/>
              <li>
                <a href="http://www.ull.es/view/centros/etsii/Inicio/es" class="links">
                  Escuela T&eacute;cnica Superior de Ingenier&iacute;a Inform&aacute;tica</a>
                |
                <a href="http://www.ull.es/" class="links">Universidad de la Laguna</a>
              </li>
            </ul>
          </div>
        </div>
      
      <!-- Seed: 107987573442722502998610715058883637676 -->
<form id="form">
  <ol class="questions">
    <li id="question-0" class="question fillin ">
      <div class="quiz text">
[1 point] 
Dado un conjunto $A$, se define $A^*$ el cierre de Kleene de $A$ como:
\( A^* = \cup_{n=1}^{\infty} A^n \)
Se admite que $A^0 = { \epsilon }$, donde $\epsilon$ denota la
<input type=text id=qfi1-1 class='fillin size-15'></input> <input type=text id=qfi1-2 class='fillin size-3'></input> esto es
la palabra que tiene longitud cero, formada por cero símbolos del conjunto base $A$<div id=qfi1-2r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-1" class="question fillin ">
      <div class="quiz text">
[1 point] 
Una producción de la forma $A \rightarrow A \alpha$.
se dice que es <input type=text id=qfi2-1 class='fillin size-9'></input> por la <input type=text id=qfi2-2 class='fillin size-9'></input>
<div id=qfi2-2r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-2" class="question fillin ">
      <div class="quiz text">
[1 point] Encuentre una gramática equivalente a esta:
      <pre>
        A: A 'a' | 'b'
      </pre>
      pero que no sea recursiva por la izquierda:
      <pre>
        A: <input type=text id=qfi3-1 class='fillin size-5'></input>
        R: /* vacío */ | <input type=text id=qfi3-2 class='fillin size-5'></input>
      </pre>
    <div id=qfi3-2r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-3" class="question fillin ">
      <div class="quiz text">
[1 point] 
Recuerde el <b>analizador sintáctico descendente predictivo recursivo</b> 
para la <a id="grammar">gramática</a>:<br/>
<ul>
  <li> $\Sigma = \{ ; =, ID, P, ADDOP, MULOP, COMPARISON, (, ), NUM \}$
  <li> $V = \{ statements, statement, condition, expression, term, factor \}$
  <li> Productions:
  <ol>
    <li>
    statements  $ \rightarrow$ statement ';' statements  $\vert$ statement
    <li>
    statement  $ \rightarrow$ ID '=' expression  $\vert$ P expression
 $ \vert$ IF condition THEN statement·
    <li> condition $ \rightarrow$ expression COMPARISON expression
    <li>
    expression  $ \rightarrow$ term ADDOP expression  $\vert$ term
    <li>
    term  $ \rightarrow$ factor MULOP term  $\vert$ factor
    <li>
    factor  $ \rightarrow$ '(' expression ')' $\vert$ ID $ \vert$ NUM
  </ol>
  <li> Start symbol: $statements$
</ul>
Rellene las partes que faltan de código CoffeeScript del 
método que se encarga de reconocer el lenguaje generado
por <tt>expression</tt>:
<pre>
  expression = ->
    result = term()
    while <input type=text id=qfi4-1 class='fillin size-9'></input> and <input type=text id=qfi4-2 class='fillin size-14'></input> is "ADDOP"
      type = <input type=text id=qfi4-3 class='fillin size-9'></input>.<input type=text id=qfi4-4 class='fillin size-5'></input>
      match "ADDOP"
      right = <input type=text id=qfi4-5 class='fillin size-6'></input>
      result =
        type: <input type=text id=qfi4-6 class='fillin size-4'></input>
        left: result
        right: right
    result
</pre>
<div id=qfi4-6r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-4" class="question fillin ">
      <div class="quiz text">
[3 points] 
Rellene las partes que faltan de código CoffeeScript del 
método que se encarga de reconocer el lenguaje generado
por <tt>statement</tt> para la <a href="#grammar">gramática
definida anteriormente</a>:
<pre>
  statement = ->
    result = null
    if <input type=text id=qfi5-1 class='fillin size-9'></input> and <input type=text id=qfi5-2 class='fillin size-9'></input>.<input type=text id=qfi5-3 class='fillin size-4'></input> is "ID"
      left =
        type: "ID"
        value: <input type=text id=qfi5-4 class='fillin size-9'></input>.<input type=text id=qfi5-5 class='fillin size-5'></input>

      match "ID"
      match "="
      right = <input type=text id=qfi5-6 class='fillin size-10'></input>()
      result =
        type: "="
        left: left
        right: right
    else if lookahead and lookahead.type is "P"
      match "P"
      right = <input type=text id=qfi5-7 class='fillin size-12'></input>
      result =
        type: "P"
        value: right
    else if lookahead and lookahead.type is "IF"
      match "IF"
      left = <input type=text id=qfi5-8 class='fillin size-11'></input>
      match "THEN"
      right = <input type=text id=qfi5-9 class='fillin size-11'></input>
      result =
        type: "IF"
        left: left
        right: right
    else # Error!
      throw "Syntax Error. Expected identifier but found " + 
        (if lookahead then lookahead.value else "end of input") + 
        " near '#{input.substr(lookahead.from)}'"
    result

</pre>
<div id=qfi5-9r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-5" class="question fillin ">
      <div class="quiz text">
[1 point] Rellene las partes que faltan del código CoffeeScript
que reconoce el sublenguaje generado por <i>condition</i>:
  <pre>
  condition = ->
    left = <input type=text id=qfi6-1 class='fillin size-11'></input>
    type = <input type=text id=qfi6-2 class='fillin size-9'></input>.<input type=text id=qfi6-3 class='fillin size-5'></input>
    match "COMPARISON"
    right = <input type=text id=qfi6-4 class='fillin size-10'></input>()
    result =
      type: type
      left: left
      right: right
    result
  </pre>
<div id=qfi6-4r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-6" class="question fillin ">
      <div class="quiz text">
[1 point] 
Complete este fragmento de <tt>slim</tt> que establece el favicon de 
la página HTML:
<pre>
    link rel="<input type=text id=qfi7-1 class='fillin size-13'></input>" type="image/jpg" href="images/favicon.jpg"
</pre><div id=qfi7-1r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-7" class="question fillin ">
      <div class="quiz text">
[6 points] 
      Para que un repositorio con una aplicación escrita en Ruby-Sinatra
      pueda desplegarse en Heroku con nombre <tt>chuchu</tt> el primer comando   que debemos escribir es:
      <pre>
      heroku <input type=text id=qfi8-1 class='fillin size-6'></input> <input type=text id=qfi8-2 class='fillin size-6'></input>
      </pre>
      Este comando crea un remoto git cuyo nombre es <input type=text id=qfi8-3 class='fillin size-6'></input>
      y cuya URL es 
      <pre>
        git@heroku.com:<input type=text id=qfi8-4 class='fillin size-7'></input>.git
      </pre>
      La URL de publicación/despliegue será:
      http://<input type=text id=qfi8-5 class='fillin size-9'></input>.<input type=text id=qfi8-6 class='fillin size-9'></input>.com/
      <br/>
      Una vez que todo esta listo, para publicar nuestra versión
      en la rama <tt>master</tt> en heroku debemos ejecutar el comando:
      <pre>
      git <input type=text id=qfi8-7 class='fillin size-4'></input> <input type=text id=qfi8-8 class='fillin size-6'></input> master
      <br/>
      </pre>
      Si la versión que queremos publicar en heroku no está en la rama
      <tt>master</tt> sino que está en la rama <tt>tutu</tt> deberemos 
      modificar el comando anterior:
      <pre>
      git push <input type=text id=qfi8-9 class='fillin size-6'></input> <input type=text id=qfi8-10 class='fillin size-4'></input>:<input type=text id=qfi8-11 class='fillin size-6'></input>
      </pre>
      Para ver los logs deberemos emitir el comando:
      <pre>
       heroku <input type=text id=qfi8-12 class='fillin size-4'></input>
      </pre>
    <div id=qfi8-12r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-8" class="question fillin ">
      <div class="quiz text">
[1 point] Con que subcomando del cliente <tt>heroku</tt> abro el navegador
    en la URL del proyecto?<br/>
    <pre>
    heroku <input type=text id=qfi9-1 class='fillin size-4'></input>
    </pre><div id=qfi9-1r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-9" class="question fillin ">
      <div class="quiz text">
[1 point] 
      Escriba la parte que falta para que 
      el programa PEGJS reconozca el lenguaje
      $\{ a^n b^n c^n\ /\ n \ge{} 1\}$
      <pre>
      S = <input type=text id=qfi10-1 class='fillin size-8'></input> 'a'+ B !('a'/'b'/'c')
      A = 'a' A? 'b'
      B = 'b' B? 'c'
      </pre>
    <div id=qfi10-1r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-10" class="question multiplechoice ">
      <div class="quiz text">
[1 point] 
Dado el PEGjs<a id="pegif"></a>:
<pre>
S =   if C:C then S1:S else S2:S { return [ 'ifthenelse', C, S1, S2 ]; }
    / if C:C then S:S            { return [ 'ifthen', C, S]; }
    / O                          { return 'O'; }
_ = ' '*
C = _'c'_                        { return 'c'; }
O = _'o'_                        { return 'o'; }
else = _'else'_                 
if = _'if'_
then = _'then'_    
</pre>
Considere esta entrada:
<pre>
if c then if c then o else o
</pre>
<!-- ['ifthen', 'c', ['ifthenelse', 'c', 'o', 'o']] -->
¿Cuál de los dos árboles es construido para la misma?:
<br></br>      </div>
      <ol class="answers">
        <input type="radio" id="qmc11-1" name="qmc11" class="select">
<tt>['ifthen', 'c', ['ifthenelse', 'c', 'o', 'o']]</tt><br class=qmc11-1br>        </input>
        <div id="qmc11-1r" class="quiz">
        </div>
        <input type="radio" id="qmc11-2" name="qmc11" class="select">
<tt>['ifthenelse', 'c', ['ifthen', 'c', 'o'], 'o']]</tt><br class=qmc11-2br>        </input>
        <div id="qmc11-2r" class="quiz">
        </div>
        <br/>
      </ol>
    </li>
    <li id="question-11" class="question multiplechoice ">
      <div class="quiz text">
[1 point] Si en el <a href="#pegif">peg anterior</a> cambiamos el orden de las dos primeras reglas de <tt>S</tt>:
<pre>
  S =   if C:C then S:S            { return [ 'ifthen', C, S]; }
      / if C:C then S1:S else S2:S { return [ 'ifthenelse', C, S1, S2 ]; }
</pre>
Para la misma entrada:
<pre>
if c then if c then o else o
</pre>
<!-- ['ifthen', 'c', ['ifthenelse', 'c', 'o', 'o']] -->
¿Cuál de las respuestas es correcta?
    <br></br>      </div>
      <ol class="answers">
        <input type="radio" id="qmc12-1" name="qmc12" class="select">
<tt>['ifthenelse', 'c', ['ifthen', 'c', 'o'], 'o']]</tt><br class=qmc12-1br>        </input>
        <div id="qmc12-1r" class="quiz">
        </div>
        <input type="radio" id="qmc12-2" name="qmc12" class="select">
<tt>['ifthen', 'c', ['ifthenelse', 'c', 'o', 'o']]</tt><br class=qmc12-2br>        </input>
        <div id="qmc12-2r" class="quiz">
        </div>
        <input type="radio" id="qmc12-3" name="qmc12" class="select">
<tt>Syntax Error</tt>. La frase no es aceptada por el peg<br class=qmc12-3br>        </input>
        <div id="qmc12-3r" class="quiz">
        </div>
        <br/>
      </ol>
    </li>
    <li id="question-12" class="question fillin ">
      <div class="quiz text">
[1 point] 
Rellene las partes que faltan de este código para que funcione:
<pre>
var PEG = require ("pegjs");
var grammar = "s = ('a' / 'b')+";
var parser = PEG.<input type=text id=qfi13-1 class='fillin size-11'></input>(grammar);
var input = process.argv[<input type=text id=qfi13-2 class='fillin size-3'></input>] || 'abba';
console.log(parser.parse(input))
</pre>
Cuando se ejecuta, este código produce:
<pre>
[~/srcPLgrado/pegjs/examples(master)]$ node abba.pegjs abb
[ 'a', 'b', 'b' ]
</pre>
    <div id=qfi13-2r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-13" class="question fillin ">
      <div class="quiz text">
[1 point] 
<a id="anbncn"></a>
Complete las partes que faltan para que el PEGjs reconozca este
clásico ejemplo de lenguaje que no es independiente del contexto
               $\{ a^nb^nc^n / n \ge{} 1 \}$
<pre>
S = <input type=text id=qfi14-1 class='fillin size-3'></input>(<input type=text id=qfi14-2 class='fillin size-3'></input> <input type=text id=qfi14-3 class='fillin size-3'></input>) 'a'+ B:<input type=text id=qfi14-4 class='fillin size-3'></input> !('c'/[<input type=text id=qfi14-5 class='fillin size-3'></input>]) { return B; }
A = 'a' A:A? 'b' { if (A) { return A+1; } else return 1; }
B = 'b' B:B? 'c' { if (B) { return B+1; } else return 1; }
</pre>
    <div id=qfi14-5r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-14" class="question fillin ">
      <div class="quiz text">
[1 point] 
rellene las partes que faltan del siguiente programa PEGjs que reconoce
los comentarios Pascal:
<pre>
P     =   prog:N+                          { return prog; }
N     =   chars:$(!Begin ANY)+             { return chars;}
        / C
C     = Begin chars:<input type=text id=qfi15-1 class='fillin size-3'></input> End                { return chars.join(''); }
T     =   C 
        / (!<input type=text id=qfi15-2 class='fillin size-5'></input> <input type=text id=qfi15-3 class='fillin size-4'></input> char:ANY)           { return char;}
Begin = '(*'
End   = '*)'
ANY   =   'z'    /* any character */       { return 'z';  }
        / char:<input type=text id=qfi15-4 class='fillin size-4'></input>                        { return char; }    
</pre>
    <div id=qfi15-4r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-15" class="question fillin ">
      <div class="quiz text">
[4 points] 
Rellene las partes que faltan de esta clase que implementa 
persistencia para programas PL0 usando el ORM DataMapper:
<pre>
DataMapper.<input type=text id=qfi16-1 class='fillin size-5'></input>(:default,·
                 ENV['DATABASE_URL'] || "sqlite3://#{Dir.pwd}/database.db" )

class PL0Program
  include <input type=text id=qfi16-2 class='fillin size-10'></input>::<input type=text id=qfi16-3 class='fillin size-8'></input>
··
  <input type=text id=qfi16-4 class='fillin size-8'></input> :name, String, :key => true
  <input type=text id=qfi16-5 class='fillin size-8'></input> :source, String, :length => 1..1024
end

  DataMapper.<input type=text id=qfi16-6 class='fillin size-8'></input>
  DataMapper.<input type=text id=qfi16-7 class='fillin size-13'></input>
</pre>
<div id=qfi16-7r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-16" class="question fillin ">
      <div class="quiz text">
[1 point] 
Rellene las partes que faltan del siguiente fragmento de código
de la ruta <tt>/save</tt>
que guarda el programa solicitado:
<pre>
post '/save' do
  name = params[:fname]
  c  = PL0Program.<input type=text id=qfi17-1 class='fillin size-5'></input>(:name => name)
  if c
    c.source = params["input"]
    c.<input type=text id=qfi17-2 class='fillin size-4'></input>
  else
    c = PL0Program.new
    c.name = params["fname"]
    c.source = params["input"]
    c.<input type=text id=qfi17-3 class='fillin size-4'></input>
  end
  <input type=text id=qfi17-4 class='fillin size-8'></input> '/'
end
</pre>
<div id=qfi17-4r class=quiz></div></br></br>      </div>
    </li>
    <li id="question-17" class="question fillin ">
      <div class="quiz text">
[4 points] 
En la práctica del PEGjs tratabamos las expresiones aritméticas 
mediante estas dos reglas:
<pre>
exp    = t:term   r:(ADD term)*   { return tree(t,r); }
term   = f:factor r:(MUL factor)* { return tree(f,r); }
ADD      = _ op:[+-] _ { return op; }
MUL      = _ op:[*/] _ { return op; }
</pre>
Complete el código de <tt>tree</tt>:
<pre>
{
  var tree = function(f, r) {
    if (r.<input type=text id=qfi18-1 class='fillin size-6'></input> > 0) {
      var last = r.<input type=text id=qfi18-2 class='fillin size-3'></input>();
      var result = {
        type:  <input type=text id=qfi18-3 class='fillin size-7'></input>,
        left: <input type=text id=qfi18-4 class='fillin size-10'></input>,
        right: <input type=text id=qfi18-5 class='fillin size-7'></input>
      };
    }
    else {
      var result = f;
    }
    return result;
  }
}
</pre>
<div id=qfi18-5r class=quiz></div></br></br>      </div>
    </li>
  </ol>
  <div class="btn-footer">
    <button type="button" id="submit" class="btn btn-primary">
Submit    </button>
    <button type="button" id="reset" class="btn btn-warning">
Reset    </button>
    <button type="button" id="deletestorage" class="btn btn-danger">
Delete storage    </button>
  </div>
</form>

      
        <div id="footer">
          <div class="row text-muted">
            <div class="col-md-6">
              Quiz generated using the RuQL Gem. For more information, visit <a href="https://github.com/jjlabrador/ruql">GitHub
              <span class="glyphicon glyphicon-link"></span></a>
            </div>
            <div class="col-md-3"></div>
            <div class="col-md-3">
              Universidad de La Laguna 2014
            </div>
          </div>
        </div>
      
    </div>
    <!-- JavaScripts -->
    <!-- jQuery -->
    
        <script type=text/javascript src=http://code.jquery.com/jquery-2.1.0.min.js></script>
        <!--[if lt IE 8]>
          <script type=text/javascript src=http://code.jquery.com/jquery-1.11.0.min.js></script>
        <![endif]-->
      
    <!-- Codehelper -->
    <script type=text/javascript src=http://www.codehelper.io/api/ips/?js></script>
    <!-- Internationalization -->
    <script>      i18n = {};
      i18n['ES'] = {}
      i18n['ES']['correct'] = "Correcto";
      i18n['ES']['incorrect'] = "Incorrecto";
      i18n['ES']['points'] = "puntos";
      i18n['EN'] = {}
      i18n['EN']['correct'] = "Correct";
      i18n['EN']['incorrect'] = "Incorrect";
      i18n['EN']['points'] = "points";
</script>
    <!-- XRegexp -->
    <script type=text/javascript src=http://cdnjs.cloudflare.com/ajax/libs/xregexp/2.0.0/xregexp-min.js></script>
    <!-- Form validation -->
    <script>      data = {"question-0":{"question_text":"\nDado un conjunto $A$, se define $A^*$ el cierre de Kleene de $A$ como:\n\\( A^* = \\cup_{n=1}^{\\infty} A^n \\)\nSe admite que $A^0 = { \\epsilon }$, donde $\\epsilon$ denota la\n--------------- --- esto es\nla palabra que tiene longitud cero, formada por cero símbolos del conjunto base $A$.","answers":{"qfi1-1":{"answer_text":"/palabra/i","correct":true,"explanation":null,"type":"Regexp"},"qfi1-2":{"answer_text":"/vac[ií]a/i","correct":true,"explanation":null,"type":"Regexp"}},"points":1,"order":true,"question_comment":""},"question-1":{"question_text":"\nUna producción de la forma $A \\rightarrow A \\alpha$.\nse dice que es --------- por la ---------\n","answers":{"qfi2-1":{"answer_text":"/recursiva/i","correct":true,"explanation":null,"type":"Regexp"},"qfi2-2":{"answer_text":"/izquierda/i","correct":true,"explanation":null,"type":"Regexp"}},"points":1,"order":true,"question_comment":""},"question-2":{"question_text":"Encuentre una gramática equivalente a esta:\n      <pre>\n        A: A 'a' | 'b'\n      </pre>\n      pero que no sea recursiva por la izquierda:\n      <pre>\n        A: -----\n        R: /* vacío */ | -----\n      </pre>\n    ","answers":{"qfi3-1":{"answer_text":"/'b'\\s*R/","correct":true,"explanation":null,"type":"Regexp"},"qfi3-2":{"answer_text":"/'a'\\s*R/","correct":true,"explanation":null,"type":"Regexp"}},"points":1,"order":true,"question_comment":""},"question-3":{"question_text":"\nRecuerde el <b>analizador sintáctico descendente predictivo recursivo</b> \npara la <a id=\"grammar\">gramática</a>:<br/>\n<ul>\n  <li> $\\Sigma = \\{ ; =, ID, P, ADDOP, MULOP, COMPARISON, (, ), NUM \\}$\n  <li> $V = \\{ statements, statement, condition, expression, term, factor \\}$\n  <li> Productions:\n  <ol>\n    <li>\n    statements  $ \\rightarrow$ statement ';' statements  $\\vert$ statement\n    <li>\n    statement  $ \\rightarrow$ ID '=' expression  $\\vert$ P expression\n $ \\vert$ IF condition THEN statement·\n    <li> condition $ \\rightarrow$ expression COMPARISON expression\n    <li>\n    expression  $ \\rightarrow$ term ADDOP expression  $\\vert$ term\n    <li>\n    term  $ \\rightarrow$ factor MULOP term  $\\vert$ factor\n    <li>\n    factor  $ \\rightarrow$ '(' expression ')' $\\vert$ ID $ \\vert$ NUM\n  </ol>\n  <li> Start symbol: $statements$\n</ul>\nRellene las partes que faltan de código CoffeeScript del \nmétodo que se encarga de reconocer el lenguaje generado\npor <tt>expression</tt>:\n<pre>\n  expression = ->\n    result = term()\n    while --------- and -------------- is \"ADDOP\"\n      type = ---------.-----\n      match \"ADDOP\"\n      right = ------\n      result =\n        type: ----\n        left: result\n        right: right\n    result\n</pre>\n","answers":{"qfi4-1":{"answer_text":"lookahead","correct":true,"explanation":null,"type":"String"},"qfi4-2":{"answer_text":"lookahead.type","correct":true,"explanation":null,"type":"String"},"qfi4-3":{"answer_text":"lookahead","correct":true,"explanation":null,"type":"String"},"qfi4-4":{"answer_text":"value","correct":true,"explanation":null,"type":"String"},"qfi4-5":{"answer_text":"term()","correct":true,"explanation":null,"type":"String"},"qfi4-6":{"answer_text":"type","correct":true,"explanation":null,"type":"String"}},"points":1,"order":true,"question_comment":""},"question-4":{"question_text":"\nRellene las partes que faltan de código CoffeeScript del \nmétodo que se encarga de reconocer el lenguaje generado\npor <tt>statement</tt> para la <a href=\"#grammar\">gramática\ndefinida anteriormente</a>:\n<pre>\n  statement = ->\n    result = null\n    if --------- and ---------.---- is \"ID\"\n      left =\n        type: \"ID\"\n        value: ---------.-----\n\n      match \"ID\"\n      match \"=\"\n      right = ----------()\n      result =\n        type: \"=\"\n        left: left\n        right: right\n    else if lookahead and lookahead.type is \"P\"\n      match \"P\"\n      right = ------------\n      result =\n        type: \"P\"\n        value: right\n    else if lookahead and lookahead.type is \"IF\"\n      match \"IF\"\n      left = -----------\n      match \"THEN\"\n      right = -----------\n      result =\n        type: \"IF\"\n        left: left\n        right: right\n    else # Error!\n      throw \"Syntax Error. Expected identifier but found \" + \n        (if lookahead then lookahead.value else \"end of input\") + \n        \" near '#{input.substr(lookahead.from)}'\"\n    result\n\n</pre>\n","answers":{"qfi5-1":{"answer_text":"lookahead","correct":true,"explanation":null,"type":"String"},"qfi5-2":{"answer_text":"lookahead","correct":true,"explanation":null,"type":"String"},"qfi5-3":{"answer_text":"type","correct":true,"explanation":null,"type":"String"},"qfi5-4":{"answer_text":"lookahead","correct":true,"explanation":null,"type":"String"},"qfi5-5":{"answer_text":"value","correct":true,"explanation":null,"type":"String"},"qfi5-6":{"answer_text":"expression","correct":true,"explanation":null,"type":"String"},"qfi5-7":{"answer_text":"expression()","correct":true,"explanation":null,"type":"String"},"qfi5-8":{"answer_text":"condition()","correct":true,"explanation":null,"type":"String"},"qfi5-9":{"answer_text":"statement()","correct":true,"explanation":null,"type":"String"}},"points":3,"order":true,"question_comment":""},"question-5":{"question_text":"Rellene las partes que faltan del código CoffeeScript\nque reconoce el sublenguaje generado por <i>condition</i>:\n  <pre>\n  condition = ->\n    left = -----------\n    type = ---------.-----\n    match \"COMPARISON\"\n    right = ----------()\n    result =\n      type: type\n      left: left\n      right: right\n    result\n  </pre>\n","answers":{"qfi6-1":{"answer_text":"expression()","correct":true,"explanation":null,"type":"String"},"qfi6-2":{"answer_text":"lookahead","correct":true,"explanation":null,"type":"String"},"qfi6-3":{"answer_text":"value","correct":true,"explanation":null,"type":"String"},"qfi6-4":{"answer_text":"expression","correct":true,"explanation":null,"type":"String"}},"points":1,"order":true,"question_comment":""},"question-6":{"question_text":"\nComplete este fragmento de <tt>slim</tt> que establece el favicon de \nla página HTML:\n<pre>\n    link rel=\"-------------\" type=\"image/jpg\" href=\"images/favicon.jpg\"\n</pre>","answers":{"qfi7-1":{"answer_text":"/(shortcut\\s+)?icon/i","correct":true,"explanation":null,"type":"Regexp"}},"points":1,"order":true,"question_comment":""},"question-7":{"question_text":"\n      Para que un repositorio con una aplicación escrita en Ruby-Sinatra\n      pueda desplegarse en Heroku con nombre <tt>chuchu</tt> el primer comando   que debemos escribir es:\n      <pre>\n      heroku ------ ------\n      </pre>\n      Este comando crea un remoto git cuyo nombre es ------\n      y cuya URL es \n      <pre>\n        git@heroku.com:-------.git\n      </pre>\n      La URL de publicación/despliegue será:\n      http://---------.---------.com/\n      <br/>\n      Una vez que todo esta listo, para publicar nuestra versión\n      en la rama <tt>master</tt> en heroku debemos ejecutar el comando:\n      <pre>\n      git ---- ------ master\n      <br/>\n      </pre>\n      Si la versión que queremos publicar en heroku no está en la rama\n      <tt>master</tt> sino que está en la rama <tt>tutu</tt> deberemos \n      modificar el comando anterior:\n      <pre>\n      git push ------ ----:------\n      </pre>\n      Para ver los logs deberemos emitir el comando:\n      <pre>\n       heroku ----\n      </pre>\n    ","answers":{"qfi8-1":{"answer_text":"create","correct":true,"explanation":null,"type":"String"},"qfi8-2":{"answer_text":"chuchu","correct":true,"explanation":null,"type":"String"},"qfi8-3":{"answer_text":"heroku","correct":true,"explanation":null,"type":"String"},"qfi8-4":{"answer_text":"chuchu","correct":true,"explanation":null,"type":"String"},"qfi8-5":{"answer_text":"chuchu","correct":true,"explanation":null,"type":"String"},"qfi8-6":{"answer_text":"herokuapp","correct":true,"explanation":null,"type":"String"},"qfi8-7":{"answer_text":"push","correct":true,"explanation":null,"type":"String"},"qfi8-8":{"answer_text":"heroku","correct":true,"explanation":null,"type":"String"},"qfi8-9":{"answer_text":"heroku","correct":true,"explanation":null,"type":"String"},"qfi8-10":{"answer_text":"tutu","correct":true,"explanation":null,"type":"String"},"qfi8-11":{"answer_text":"master","correct":true,"explanation":null,"type":"String"},"qfi8-12":{"answer_text":"logs","correct":true,"explanation":null,"type":"String"}},"points":6,"order":true,"question_comment":""},"question-8":{"question_text":"Con que subcomando del cliente <tt>heroku</tt> abro el navegador\n    en la URL del proyecto?<br/>\n    <pre>\n    heroku ----\n    </pre>","answers":{"qfi9-1":{"answer_text":"open","correct":true,"explanation":null,"type":"String"}},"points":1,"order":true,"question_comment":""},"question-9":{"question_text":"\n      Escriba la parte que falta para que \n      el programa PEGJS reconozca el lenguaje\n      $\\{ a^n b^n c^n\\ /\\ n \\ge{} 1\\}$\n      <pre>\n      S = -------- 'a'+ B !('a'/'b'/'c')\n      A = 'a' A? 'b'\n      B = 'b' B? 'c'\n      </pre>\n    ","answers":{"qfi10-1":{"answer_text":"/\\&\\s*\\(\\s*A\\s*'c'\\s*\\)/","correct":true,"explanation":null,"type":"Regexp"}},"points":1,"order":true,"question_comment":""},"question-10":{"question_text":"\nDado el PEGjs<a id=\"pegif\"></a>:\n<pre>\nS =   if C:C then S1:S else S2:S { return [ 'ifthenelse', C, S1, S2 ]; }\n    / if C:C then S:S            { return [ 'ifthen', C, S]; }\n    / O                          { return 'O'; }\n_ = ' '*\nC = _'c'_                        { return 'c'; }\nO = _'o'_                        { return 'o'; }\nelse = _'else'_                 \nif = _'if'_\nthen = _'then'_    \n</pre>\nConsidere esta entrada:\n<pre>\nif c then if c then o else o\n</pre>\n<!-- ['ifthen', 'c', ['ifthenelse', 'c', 'o', 'o']] -->\n¿Cuál de los dos árboles es construido para la misma?:\n","answers":{"qmc11-1":{"answer_text":"<tt>['ifthen', 'c', ['ifthenelse', 'c', 'o', 'o']]</tt>","correct":true,"explanation":null},"qmc11-2":{"answer_text":"<tt>['ifthenelse', 'c', ['ifthen', 'c', 'o'], 'o']]</tt>","correct":false,"explanation":""}},"points":1,"question_comment":""},"question-11":{"question_text":"Si en el <a href=\"#pegif\">peg anterior</a> cambiamos el orden de las dos primeras reglas de <tt>S</tt>:\n<pre>\n  S =   if C:C then S:S            { return [ 'ifthen', C, S]; }\n      / if C:C then S1:S else S2:S { return [ 'ifthenelse', C, S1, S2 ]; }\n</pre>\nPara la misma entrada:\n<pre>\nif c then if c then o else o\n</pre>\n<!-- ['ifthen', 'c', ['ifthenelse', 'c', 'o', 'o']] -->\n¿Cuál de las respuestas es correcta?\n    ","answers":{"qmc12-1":{"answer_text":"<tt>['ifthenelse', 'c', ['ifthen', 'c', 'o'], 'o']]</tt>","correct":false,"explanation":""},"qmc12-2":{"answer_text":"<tt>['ifthen', 'c', ['ifthenelse', 'c', 'o', 'o']]</tt>","correct":false,"explanation":""},"qmc12-3":{"answer_text":"<tt>Syntax Error</tt>. La frase no es aceptada por el peg","correct":true,"explanation":null}},"points":1,"question_comment":""},"question-12":{"question_text":"\nRellene las partes que faltan de este código para que funcione:\n<pre>\nvar PEG = require (\"pegjs\");\nvar grammar = \"s = ('a' / 'b')+\";\nvar parser = PEG.-----------(grammar);\nvar input = process.argv[---] || 'abba';\nconsole.log(parser.parse(input))\n</pre>\nCuando se ejecuta, este código produce:\n<pre>\n[~/srcPLgrado/pegjs/examples(master)]$ node abba.pegjs abb\n[ 'a', 'b', 'b' ]\n</pre>\n    ","answers":{"qfi13-1":{"answer_text":"buildparser","correct":true,"explanation":null,"type":"String"},"qfi13-2":{"answer_text":"2","correct":true,"explanation":null,"type":"String"}},"points":1,"order":true,"question_comment":""},"question-13":{"question_text":"\n<a id=\"anbncn\"></a>\nComplete las partes que faltan para que el PEGjs reconozca este\nclásico ejemplo de lenguaje que no es independiente del contexto\n               $\\{ a^nb^nc^n / n \\ge{} 1 \\}$\n<pre>\nS = ---(--- ---) 'a'+ B:--- !('c'/[---]) { return B; }\nA = 'a' A:A? 'b' { if (A) { return A+1; } else return 1; }\nB = 'b' B:B? 'c' { if (B) { return B+1; } else return 1; }\n</pre>\n    ","answers":{"qfi14-1":{"answer_text":"&","correct":true,"explanation":null,"type":"String"},"qfi14-2":{"answer_text":"a","correct":true,"explanation":null,"type":"String"},"qfi14-3":{"answer_text":"'c'","correct":true,"explanation":null,"type":"String"},"qfi14-4":{"answer_text":"b","correct":true,"explanation":null,"type":"String"},"qfi14-5":{"answer_text":"^c","correct":true,"explanation":null,"type":"String"}},"points":1,"order":true,"question_comment":""},"question-14":{"question_text":"\nrellene las partes que faltan del siguiente programa PEGjs que reconoce\nlos comentarios Pascal:\n<pre>\nP     =   prog:N+                          { return prog; }\nN     =   chars:$(!Begin ANY)+             { return chars;}\n        / C\nC     = Begin chars:--- End                { return chars.join(''); }\nT     =   C \n        / (!----- ---- char:ANY)           { return char;}\nBegin = '(*'\nEnd   = '*)'\nANY   =   'z'    /* any character */       { return 'z';  }\n        / char:----                        { return char; }    \n</pre>\n    ","answers":{"qfi15-1":{"answer_text":"t*","correct":true,"explanation":null,"type":"String"},"qfi15-2":{"answer_text":"begin","correct":true,"explanation":null,"type":"String"},"qfi15-3":{"answer_text":"!end","correct":true,"explanation":null,"type":"String"},"qfi15-4":{"answer_text":"[^z]","correct":true,"explanation":null,"type":"String"}},"points":1,"order":true,"question_comment":""},"question-15":{"question_text":"\nRellene las partes que faltan de esta clase que implementa \npersistencia para programas PL0 usando el ORM DataMapper:\n<pre>\nDataMapper.-----(:default,·\n                 ENV['DATABASE_URL'] || \"sqlite3://#{Dir.pwd}/database.db\" )\n\nclass PL0Program\n  include ----------::--------\n··\n  -------- :name, String, :key => true\n  -------- :source, String, :length => 1..1024\nend\n\n  DataMapper.--------\n  DataMapper.-------------\n</pre>\n","answers":{"qfi16-1":{"answer_text":"setup","correct":true,"explanation":null,"type":"String"},"qfi16-2":{"answer_text":"datamapper","correct":true,"explanation":null,"type":"String"},"qfi16-3":{"answer_text":"resource","correct":true,"explanation":null,"type":"String"},"qfi16-4":{"answer_text":"property","correct":true,"explanation":null,"type":"String"},"qfi16-5":{"answer_text":"property","correct":true,"explanation":null,"type":"String"},"qfi16-6":{"answer_text":"finalize","correct":true,"explanation":null,"type":"String"},"qfi16-7":{"answer_text":"auto_upgrade!","correct":true,"explanation":null,"type":"String"}},"points":4,"order":true,"question_comment":""},"question-16":{"question_text":"\nRellene las partes que faltan del siguiente fragmento de código\nde la ruta <tt>/save</tt>\nque guarda el programa solicitado:\n<pre>\npost '/save' do\n  name = params[:fname]\n  c  = PL0Program.-----(:name => name)\n  if c\n    c.source = params[\"input\"]\n    c.----\n  else\n    c = PL0Program.new\n    c.name = params[\"fname\"]\n    c.source = params[\"input\"]\n    c.----\n  end\n  -------- '/'\nend\n</pre>\n","answers":{"qfi17-1":{"answer_text":"first","correct":true,"explanation":null,"type":"String"},"qfi17-2":{"answer_text":"save","correct":true,"explanation":null,"type":"String"},"qfi17-3":{"answer_text":"save","correct":true,"explanation":null,"type":"String"},"qfi17-4":{"answer_text":"redirect","correct":true,"explanation":null,"type":"String"}},"points":1,"order":true,"question_comment":""},"question-17":{"question_text":"\nEn la práctica del PEGjs tratabamos las expresiones aritméticas \nmediante estas dos reglas:\n<pre>\nexp    = t:term   r:(ADD term)*   { return tree(t,r); }\nterm   = f:factor r:(MUL factor)* { return tree(f,r); }\nADD      = _ op:[+-] _ { return op; }\nMUL      = _ op:[*/] _ { return op; }\n</pre>\nComplete el código de <tt>tree</tt>:\n<pre>\n{\n  var tree = function(f, r) {\n    if (r.------ > 0) {\n      var last = r.---();\n      var result = {\n        type:  -------,\n        left: ----------,\n        right: -------\n      };\n    }\n    else {\n      var result = f;\n    }\n    return result;\n  }\n}\n</pre>\n","answers":{"qfi18-1":{"answer_text":"length","correct":true,"explanation":null,"type":"String"},"qfi18-2":{"answer_text":"pop","correct":true,"explanation":null,"type":"String"},"qfi18-3":{"answer_text":"/last\\s*\\[\\s*0\\s*\\]/","correct":true,"explanation":null,"type":"Regexp"},"qfi18-4":{"answer_text":"/tree\\s*\\(\\s*f\\s*,\\s*r\\s*\\)/","correct":true,"explanation":null,"type":"Regexp"},"qfi18-5":{"answer_text":"/last\\s*\\[\\s*1\\s*\\]/","correct":true,"explanation":null,"type":"Regexp"}},"points":4,"order":true,"question_comment":""}};

      function findCorrectAnswer(idQuestion, questionType) {
        correctIds = [];
        for (id in data[idQuestion]['answers']) {
          if(data[idQuestion]['answers'][id.toString()]['correct'] == true)
            if (questionType == 0)
              return id.toString();
            else {
              correctIds.push(id.toString());
            } 
        }
        return correctIds;
      }
      
      function checkSelectMultiple(x, checkedIds, correctIds) {
        results = [];
        
        $.each(checkedIds, function(index, value){
          if (correctIds.indexOf(value) == -1) {
            results.push(false);
            printResults(value, 0, data[x.toString()]['answers'][value]['explanation'], 0);
          }
          else {
            results.push(true);
            printResults(value, 1, data[x.toString()]['answers'][value]['explanation'], 0);
          }
        });
        
        nCorrects = 0;
        nIncorrects = 0;
        $.each(results, function(index, value){
          if (value == true)
            nCorrects += 1;
          else
            nIncorrects += 1;
        });
        
        calculateMark(data[x.toString()], x.toString(), null, 3, nCorrects, nIncorrects);
      }
      
      function printResults(id, type, explanation, typeQuestion) {
        if (typeQuestion == 0) {                                        // MultipleChoice and SelectMultiple
          $("br[class=" + id + "br" + "]").detach();
          if (type == 1) {
            if ((explanation == "") || (explanation == null))
              $("div[id ~= " + id + "r" + "]").html("<strong class=correct> " + i18n[language]['correct'] + "</strong></br>");
            else
              $("div[id ~= " + id + "r" + "]").html("<strong class=correct> " + i18n[language]['correct'] + " - " + explanation + "</strong></br>");
          }
          else {
            if ((explanation == "") || (explanation == null))
              $("div[id ~= " + id + "r" + "]").html("<strong class=incorrect> " + i18n[language]['incorrect'] + "</strong></br>");
            else
              $("div[id ~= " + id + "r" + "]").html("<strong class=incorrect> " + i18n[language]['incorrect'] + " - " + explanation + "</strong></br>");
          }
        }
        else {          // FillIn
          for (r in id) {
            input = $("#" + r.toString());
            if (id[r] == true) {
              input.attr('class', input.attr('class') + ' correct');
            }
            else { 
              if ((id[r] == false) || (id[r] != "n/a")) {
                input.attr('class', input.attr('class') + ' incorrect');
              }
            }
            
            if ((id[r] != true) && (id[r] != false) && (id[r] != "n/a")) {
              if (explanation[id[r].toString()] != null)
                $("div[id ~= " + r.toString() + "r" + "]").html(" <div class=explanation>" + explanation[id[r].toString()] + "</div>");
            }
            else {
              if (explanation[r] != null)
                $("div[id ~= " + r + "r" + "]").html(" <div class=explanation>" + explanation[r] + "</div>");
            }
          }
        }
      }
      
      function calculateMark(question, id, result, typeQuestion, numberCorrects, numberIncorrects) {
        if (typeQuestion == 2) {
          if (result)
            $("#" + id).append("<strong class=mark> " + question['points'].toFixed(2) + "/" + question['points'].toFixed(2) + " " + i18n[language]['points'] + "</strong></br></br>");
          else
            $("#" + id).append("<strong class=mark> 0.00/" + question['points'].toFixed(2) + " " + i18n[language]['points'] + "</strong></br></br>");
        }
        else if (typeQuestion == 1) {
          size = 0;
          for (y in question['answers'])
            if (question['answers'][y]['correct'] == true)
              size += 1;
              
          pointsUser = ((question['points'] / size) * numberCorrects).toFixed(2);
          $("#" + id).append("<strong class=mark> " + pointsUser + "/" + question['points'].toFixed(2) + " " + i18n[language]['points'] + "</strong></br></br>");
        }
        else {
          totalCorrects = 0;
          for (y in question['answers']) {
            if (question['answers'][y]['correct'] == true)
              totalCorrects += 1;
          }
          
          correctAnswerPoints = question['points'] / totalCorrects;
          penalty = correctAnswerPoints * numberIncorrects;
          mark = (correctAnswerPoints * numberCorrects) - penalty;
          
          if (mark < 0)
            mark = 0;
            
          $("#" + id).append("<strong class=mark> " + mark.toFixed(2) + "/" + question['points'].toFixed(2) + " " + i18n[language]['points'] + "</strong></br></br>");        
        }
      }
      
      function checkFillin(correctAnswers, userAnswers, distractorAnswers, typeCorrection) {
        correction = {};
        checkedAnswers = {};
        
        if (typeCorrection == 0) {          // Order doesn't matter
          for (u in userAnswers) {
            if (userAnswers[u] != undefined) {    // No empty field
              matchedCorrect = false;
              for (y in correctAnswers) {
                if (checkAnswers[u] == undefined) {
                  if ((typeof(correctAnswers[y]) == "string") || (typeof(correctAnswers[y]) == "number")) {    // Answer is a String or a Number
                    if (userAnswers[u] == correctAnswers[y]) {
                      correction[u] = true;
                      checkedAnswers[u] = userAnswers[u];
                      matchedCorrect = true;
                      break;
                    }
                  }
                  else {  // Answer is a Regexp
                    if (userAnswers[u].match(correctAnswers[y])) {
                      correction[u] = true;
                      checkedAnswers[u] = userAnswers[u];
                      matchedCorrect = true;
                      break;
                    }
                  }
                }
              }
              if (!matchedCorrect)
                correction[u] = false;
            }
            else
              correction[u] = "n/a";
          }
        }
        else {                            // Order matters
          for (u in userAnswers) {
            if (userAnswers[u] != undefined) {
              if ((typeof(correctAnswers[u]) == "string") || (typeof(correctAnswers[u]) == "number")) {
                if (userAnswers[u] == correctAnswers[u])
                  correction[u] = true;
                else
                  correction[u] = false;
              }
              else {
                if (userAnswers[u].match(correctAnswers[u]))
                  correction[u] = true;
                else
                  correction[u] = false;
              }
            }
            else
              correction[u] = "n/a";
          }
        }
        
        if (Object.keys(userAnswers).length == 1) {
          for (u in userAnswers) {
            if (correction[u] == false) {
              for (y in distractorAnswers) {
                if ((typeof(distractorAnswers[y]) == "string") || (typeof(distractorAnswers[y]) == "number")) {
                  if (userAnswers[u] == distractorAnswers[y])
                    correction[u] = y.toString();
                }
                else {
                  if (userAnswers[u].match(distractorAnswers[y]))
                    correction[u] = y.toString();
                }
              }
            }
          }
        }
        return correction;
      }
      
      function checkAnswers() {
        
        for (x in data) {
          if ($("#" + x.toString() + " strong").length == 0) {
            correct = false;
            answers = $("#" + x.toString() + " input");
            
            if (answers.attr('class').match("fillin")) {
              correctAnswers = {};
              distractorAnswers = {};
              explanation = {};
              stringAnswer = false;
              
              for (ans in data[x.toString()]['answers']) {
                if (data[x.toString()]['answers'][ans]['correct'] == true) {
                  if (data[x.toString()]['answers'][ans]['type'] == "Regexp") {
                    string = data[x.toString()]['answers'][ans]['answer_text'].split('/');
                    regexp = string[1];
                    options = string[2];
                    correctAnswers[ans.toString()] = RegExp(regexp, options);
                  }
                  else { // String or Number
                    correctAnswers[ans.toString()] = data[x.toString()]['answers'][ans]['answer_text'];
                    stringAnswer = true;
                  }
                }
                else {
                  if (data[x.toString()]['answers'][ans]['type'] == "Regexp") {
                    string = data[x.toString()]['answers'][ans]['answer_text'].split('/');
                    regexp = string[1];
                    options = string[2];
                    distractorAnswers[ans.toString()] = RegExp(regexp, options);
                  }
                  else {// String or Number
                    distractorAnswers[ans.toString()] = data[x.toString()]['answers'][ans]['answer_text'];
                    stringAnswer = true;
                  }
                }
                explanation[ans] = data[x.toString()]['answers'][ans]['explanation'];
              }
              
              userAnswers = {};
              for (i = 0; i < answers.length; i++) {
                if (answers[i].value == '')
                  userAnswers[answers[i].id.toString()] = undefined;
                else
                  if (stringAnswer)
                    userAnswers[answers[i].id.toString()] = answers[i].value.toLowerCase();
                  else
                    userAnswers[answers[i].id.toString()] = answers[i].value;
              }
              
              if (data[x.toString()]['order'] == false)
                results = checkFillin(correctAnswers, userAnswers, distractorAnswers, 0);
              else
                results = checkFillin(correctAnswers, userAnswers, distractorAnswers, 1);
                
              allEmpty = true;
              nCorrects = 0;
              
              for (r in results) {
                if (results[r] == true)
                  nCorrects += 1;
                if (results[r] != "n/a")
                  allEmpty = false;
              }
              
              if (!allEmpty) {
                printResults(results, null, explanation, 1);
                calculateMark(data[x.toString()], x.toString(), null, 1, nCorrects, null);
              }
            }
            
            else if (answers.attr('class') == "select") {
              idCorrectAnswer = findCorrectAnswer(x.toString(), 0);
              
              if ($("#" + x.toString() + " :checked").size() != 0) {
                if ($("#" + x.toString() + " :checked").attr('id') == idCorrectAnswer) {
                  printResults($("#" + x.toString() + " :checked").attr('id'), 1, "", 0);
                  correct = true;
                }
                else {
                  id = $("#" + x.toString() + " :checked").attr('id');
                  printResults(id, 0, data[x.toString()]['answers'][id]['explanation'], 0);
                }
                calculateMark(data[x.toString()], x.toString(), correct, 2, null, null);
              }
            }
            
            else {
              if ($("#" + x.toString() + " :checked").size() != 0) {
                answers = $("#" + x.toString() + " :checked");
                checkedIds = [];
                
                $.each(answers, function(index, value){
                  checkedIds.push(value['id']);
                });
                
                correctIds = [];
                correctIds = findCorrectAnswer(x.toString(), 1);
                checkSelectMultiple(x, checkedIds, correctIds);
              }
            }
          }
        }
      }
      
      function storeAnswers() {
        if(typeof(Storage) !== "undefined") {
          // Store
          //localStorage.lastname = "Smith";
          // Retrieve
          //document.getElementById("storage").innerHTML=localStorage.lastname;
          inputText = $('input:text').filter(function() { return $(this).val() != ""; });
          for (i = 0; i < inputText.length; i++) {
            idAnswer = inputText[i].id;
            localStorage[idAnswer] = inputText[i].value;
          }
          
          inputRadioCheckBox = $('input:checked');
          for (i = 0; i < inputRadioCheckBox.length; i++) {
            idAnswer = inputRadioCheckBox[i].id;
            nquestion = parseInt(idAnswer.split('-')[0].substr(3)) - 1;
            localStorage[idAnswer] = data["question-" + nquestion.toString()]['answers'][idAnswer]['answer_text'];
          }
        }
        else {
          alert("Sorry! No Web Storage supported.");
        }
      }
      
      function deleteAnswers() {
        localStorage.clear();
        alert("Local storage deleted");
      }
      
      if (typeof(codehelper_ip) == "undefined")
        language = "EN";
      else
        language = codehelper_ip.Country;
      
      $("#submit").click(function() {
        checkAnswers();
        filledAllQuiz = true;
        
        for (x in data) {
          if ($("#" + x.toString() + " strong").length == 0)
            filledAllQuiz = false; 
        }
        if (filledAllQuiz)
          $("#submit").detach();
        
        storeAnswers();
      });

      $("#reset").click(function() {
        window.location.reload();
      });
      
      $("#deletestorage").click(function() {
        deleteAnswers();
      });
      
      $(document).ready(function() {
        if (localStorage.length != 0) {
          for (x in localStorage) {
            if (x.match(/qfi/))                                         // FillIn question
              $("#" + x.toString()).val(localStorage[x.toString()]);
            else {                                                      // SelectMultiple/MultipleChoice question
              $("#" + x.toString()).attr('checked', 'checked');
            }
          }
        }
      });
</script>
    <!-- Any JavaScript included by the user -->
    
    <!-- Latest compiled and minified JavaScript for Bootstrap -->
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <!-- -->
  </body>
</html>
